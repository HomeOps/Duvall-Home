good_morning:
  alias: Good Morning!
  sequence:
  - alias: ''
    data:
      entity_id: alarm_control_panel.ha_alarm
    service: alarm_control_panel.alarm_disarm
  - data:
      entity_id: lock.mud_room_lock
    service: lock.unlock
good_night:
  alias: Good Night!
  sequence:
  - data:
      entity_id: group.perimeter_locks
    service: lock.lock
  - data:
      entity_id: climate.thermostat
      preset_mode: sleep
    service: climate.set_preset_mode
  - alias: ''
    data:
      entity_id: alarm_control_panel.ha_alarm
    service: alarm_control_panel.alarm_arm_night
  - data:
      sc_message: Good night!
    service: script.notify
goodbye:
  alias: Goodbye!
  sequence:
  - alias: ''
    data:
      entity_id: alarm_control_panel.ha_alarm
    service: alarm_control_panel.alarm_arm_away
  - data:
      entity_id: climate.thermostat
      preset_mode: away
    service: climate.set_preset_mode
  - service: script.lights_off
  - data:
      entity_id: group.perimeter_covers
    service: cover.close_cover
  - data:
      entity_id: group.perimeter_locks
    service: lock.lock
  - data:
      sc_message: Arming security system
    service: script.notify
i_am_back:
  alias: I am back!
  sequence:
  - alias: ''
    data:
      entity_id: alarm_control_panel.ha_alarm
    service: alarm_control_panel.alarm_disarm
  - data:
      entity_id: lock.mud_room_lock
    service: lock.unlock
  - data:
      entity_id: climate.thermostat
      preset_mode: home
    service: climate.set_preset_mode
  - data:
      entity_id: climate.thermostat
    service: climate.ecobee_resume_program
  - data:
      sc_message: Welcome back
    service: script.notify
lights_off:
  alias: Lights Off
  sequence:
  - service: group.remove
    data:
      object_id: active_lights
  - service: group.set
    data_template:
      object_id: active_lights
      add_entities: "{% for l in expand('group.all_lights') -%}{%- if not l.entity_id.endswith('vent') %}{{l.entity_id }},{% endif -%}{%- endfor %}light.eof"
  - service: light.turn_off
    data:
      entity_id: group.active_lights
  - service: group.remove
    data:
      object_id: active_covers
  - service: group.set
    data_template:
      object_id: active_covers
      add_entities: "{% for l in expand('group.all_covers') -%}{%- if not l.entity_id.endswith('vent') %}{{l.entity_id }},{% endif -%}{%- endfor %}light.eof"
  - service: cover.close_cover
    data:
      entity_id: group.active_covers
notify:
  alias: Notify
  sequence:
  - service: notify.alexa_media
    data_template:
      data:
        method: announce
        type: tts
      message: '{{ sc_message }}

        '
      target:
      - media_player.kitchen_echo
      - media_player.master_bedroom_echo
      - media_player.master_bathroom_echo
workout:
  alias: Workout
  sequence:
  - data:
      entity_id: cover.tv_room_blinds
    service: cover.close_cover
  - data:
      entity_id: light.tv_room_lights
    service: light.turn_on
notify_external:
  alias: NotifyExternal
  sequence:
  - service: notify.all
    data_template:
      message: '{{ sc_message }}'
